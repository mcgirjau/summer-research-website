<!DOCTYPE html>
  <meta charset="utf-8">
    <style>
    
    rect {
      fill: none;
      pointer-events: all;
    }
  
  .node {
    fill: #000;
  }
  
  .node text {
  pointer-events: none;
  font: 14px sans-serif;
}

  .cursor {
    fill: none;
    stroke: brown;
    pointer-events: none;
  }
  
  .link {
    stroke: #999;
  }
  
  </style>
    <body>
    <script src="d3.v3.min.js"></script>
<script>

// Various lower-level stuff to set up the visualization system

var directed = false;
var colortype = "norm"; 
  // "norm" --- color determined by distance from origin 
  // "real" --- color determined by value real component
  // "imaginary" -- color determined by value imaginary component
  
var fastrender = false;

//var width = 960, height = 500;
width  = window.innerWidth;
height = window.innerHeight;

//var color = d3.scale.category20c();
//var color = d3.interpolate("blue","red");

var spectrum = ["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"].reverse();
//var spectrum = ['#d73027','#f46d43','#fdae61','#fee090','#ffffbf','#e0f3f8','#abd9e9','#74add1','#4575b4'].reverse();

function color(x) {
  aboveColor = Math.floor(x+1);
  belowColor = Math.floor(x);
  if(belowColor >= spectrum.length-1) {
    return spectrum[spectrum.length-1];
  }
  if(aboveColor <= 0) {
    return spectrum[0];
  }
  if(x-belowColor < 0.05) {
    return spectrum[belowColor];
  }
  return blend_colors(spectrum[belowColor], spectrum[aboveColor], x-belowColor);
}
  
var svg = d3.select('body').append('svg')
    .attr('width', width)
    .attr('height', height)
    //.style("background-color", '#202020');
svg.append("rect")
    .attr("width", width)
    .attr("height", height)
    
    
var defs = svg.append("defs");

if(directed) {
  defs.selectAll("marker")
    .data(["child"])
    .enter().append("svg:marker")
    .attr("id", String)
    .attr("markerUnits", "userSpaceOnUse")
    .attr("viewBox", "0 -5 10 10")
    .attr("refX", 42) //60
    .attr("refY", 0) //-1.1
    .attr("markerWidth", 8)
    .attr("markerHeight", 8)
    .attr("orient", "auto")
    .style("fill", function(d) { return "white"; })
    .append("svg:path")
    .attr("d", "M0,-5L10,0L0,5");
}


  
// Load & Parse data about the graph

var laplacian = [[[2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0]], [[-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0], [-1, 0]], [[-1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, 0], [2, 0]]];
var V = [[[-.182574, 0], [-.258199, 0], [-.258199, 0], [.258199, 0], [-.258199, 0], [-.258199, 0], [-.258199, 0], [-.258199, 0], [-.258199, 0], [.258199, 0], [.258199, 0], [-.182574, 0], [-.258199, 0], [.258199, 0], [.258199, 0], [.258199, 0], [-.0221364, 0], [-.016141, 0], [.00528513, 0], [.0102149, 0], [-.00604225, 0], [.00350618, 0], [-.0199933, 0], [.0186096, 0], [-.0152344, 0], [.0171104, 0], [-.0305038, 0], [.00522948, 0], [-.0380449, 0], [-.0238625, 0]], [[-.182574, 0], [-.252557, 0], [-.235876, 0], [.208887, 0], [-.172769, 0], [-.129099, 0], [-.0797878, 0], [-.0269891, 0], [.0269891, 0], [-.0797878, 0], [-.129099, 0], [.182574, 0], [.252557, 0], [-.235876, 0], [-.208887, 0], [-.172769, 0], [.0318322, 0], [-.119559, 0], [-.147458, 0], [.198564, 0], [.220524, 0], [-.244456, 0], [.253924, 0], [-.258062, 0], [.0684905, 0], [-.120419, 0], [.175381, 0], [.188341, 0], [.240189, 0], [-.237137, 0]], [[-.182574, 0], [-.235876, 0], [-.172769, 0], [.0797878, 0], [.0269891, 0], [.129099, 0], [.208887, 0], [.252557, 0], [.252557, 0], [-.208887, 0], [-.129099, 0], [-.182574, 0], [-.235876, 0], [.172769, 0], [.0797878, 0], [-.0269891, 0], [.0844097, 0], [-.202304, 0], [-.243877, 0], [.255516, 0], [.226567, 0], [-.154588, 0], [.0730778, 0], [.03534, 0], [-.118753, 0], [.202906, 0], [-.253268, 0], [-.257278, 0], [-.202144, 0], [.170421, 0]], [[-.182574, 0], [-.208887, 0], [-.0797878, 0], [-.0797878, 0], [.208887, 0], [.258199, 0], [.208887, 0], [.0797878, 0], [-.0797878, 0], [.208887, 0], [.258199, 0], [.182574, 0], [.208887, 0], [-.0797878, 0], [.0797878, 0], [.208887, 0], [.133298, 0], [-.250069, 0], [-.247143, 0], [.143383, 0], [.00604225, 0], [.148915, 0], [-.238646, 0], [.250674, 0], [.163826, 0], [-.250309, 0], [.234416, 0], [.155965, 0], [-.0380449, 0], [.131811, 0]], [[-.182574, 0], [-.172769, 0], [.0269891, 0], [-.208887, 0], [.252557, 0], [.129099, 0], [-.0797878, 0], [-.235876, 0], [-.235876, 0], [.0797878, 0], [-.129099, 0], [-.182574, 0], [-.172769, 0], [-.0269891, 0], [-.208887, 0], [-.252557, 0], [.176361, 0], [-.254595, 0], [-.156009, 0], [-.0636322, 0], [-.220524, 0], [.246623, 0], [-.122968, 0], [-.0877451, 0], [-.201739, 0], [.254431, 0], [-.126025, 0], [.0485564, 0], [.240189, 0], [-.251885, 0]], [[-.182574, 0], [-.129099, 0], [.129099, 0], [-.258199, 0], [.129099, 0], [-.129099, 0], [-.258199, 0], [-.129099, 0], [.129099, 0], [-.258199, 0], [-.129099, 0], [.182574, 0], [.129099, 0], [.129099, 0], [.258199, 0], [.129099, 0], [.211715, 0], [-.215099, 0], [-.00528513, 0], [-.228539, 0], [-.226567, 0], [.00350618, 0], [.212939, 0], [-.23233, 0], [.230834, 0], [-.21456, 0], [-.0305038, 0], [-.220946, 0], [-.202144, 0], [.0238625, 0]], [[-.182574, 0], [-.0797878, 0], [.208887, 0], [-.208887, 0], [-.0797878, 0], [-.258199, 0], [-.0797878, 0], [.208887, 0], [.208887, 0], [.0797878, 0], [.258199, 0], [-.182574, 0], [-.0797878, 0], [-.208887, 0], [-.208887, 0], [.0797878, 0], [.237817, 0], [-.13841, 0], [.147458, 0], [-.242213, 0], [-.00604225, 0], [-.244456, 0], [.167485, 0], [.136315, 0], [-.249842, 0], [.137589, 0], [.175381, 0], [.247127, 0], [-.0380449, 0], [.237137, 0]], [[-.182574, 0], [-.0269891, 0], [.252557, 0], [-.0797878, 0], [-.235876, 0], [-.129099, 0], [.208887, 0], [.172769, 0], [-.172769, 0], [.208887, 0], [-.129099, 0], [.182574, 0], [.0269891, 0], [.252557, 0], [.0797878, 0], [-.235876, 0], [.253525, 0], [-.0377892, 0], [.243877, 0], [-.095605, 0], [.220524, 0], [-.154588, 0], [-.177925, 0], [.203832, 0], [.25793, 0], [-.0368281, 0], [-.253268, 0], [-.109775, 0], [.240189, 0], [-.170421, 0]], [[-.182574, 0], [.0269891, 0], [.252557, 0], [.0797878, 0], [-.235876, 0], [.129099, 0], [.208887, 0], [-.172769, 0], [-.172769, 0], [-.208887, 0], [-.129099, 0], [-.182574, 0], [.0269891, 0], [-.252557, 0], [.0797878, 0], [.235876, 0], [.258153, 0], [.0693659, 0], [.247143, 0], [.114268, 0], [.226567, 0], [.148915, 0], [-.204681, 0], [-.178928, 0], [-.254745, 0], [-.070301, 0], [.234416, 0], [-.10022, 0], [-.202144, 0], [-.131811, 0]], [[-.182574, 0], [.0797878, 0], [.208887, 0], [.208887, 0], [-.0797878, 0], [.258199, 0], [-.0797878, 0], [-.208887, 0], [.208887, 0], [-.0797878, 0], [.258199, 0], [.182574, 0], [-.0797878, 0], [.208887, 0], [-.208887, 0], [-.0797878, 0], [.251498, 0], [.164527, 0], [.156009, 0], [.248526, 0], [.00604225, 0], [.246623, 0], [.135135, 0], [-.166426, 0], [.240426, 0], [.165274, 0], [-.126025, 0], [.243895, 0], [-.0380449, 0], [.251885, 0]], [[-.182574, 0], [.129099, 0], [.129099, 0], [.258199, 0], [.129099, 0], [.129099, 0], [-.258199, 0], [.129099, 0], [.129099, 0], [.258199, 0], [-.129099, 0], [-.182574, 0], [.129099, 0], [-.129099, 0], [.258199, 0], [-.129099, 0], [.233852, 0], [.23124, 0], [.00528513, 0], [.218324, 0], [-.220524, 0], [.00350618, 0], [.232932, 0], [.21372, 0], [-.2156, 0], [-.23167, 0], [-.0305038, 0], [-.226176, 0], [.240189, 0], [-.0238625, 0]], [[-.182574, 0], [.172769, 0], [.0269891, 0], [.208887, 0], [.252557, 0], [-.129099, 0], [-.0797878, 0], [.235876, 0], [-.235876, 0], [-.0797878, 0], [-.129099, 0], [.182574, 0], [-.172769, 0], [.0269891, 0], [-.208887, 0], [.252557, 0], [.205985, 0], [.257969, 0], [-.147458, 0], [.0436489, 0], [-.226567, 0], [-.244456, 0], [-.0864388, 0], [.121747, 0], [.181351, 0], [.258009, 0], [.175381, 0], [.0587868, 0], [-.202144, 0], [-.237137, 0]], [[-.182574, 0], [.208887, 0], [-.0797878, 0], [.0797878, 0], [.208887, 0], [-.258199, 0], [.208887, 0], [-.0797878, 0], [-.0797878, 0], [-.208887, 0], [.258199, 0], [-.182574, 0], [.208887, 0], [.0797878, 0], [.0797878, 0], [-.208887, 0], [.169115, 0], [.240094, 0], [-.243877, 0], [-.159911, 0], [-.00604225, 0], [-.154588, 0], [-.251003, 0], [-.239172, 0], [-.139176, 0], [-.239735, 0], [-.253268, 0], [.147504, 0], [-.0380449, 0], [.170421, 0]], [[-.182574, 0], [.235876, 0], [-.172769, 0], [-.0797878, 0], [.0269891, 0], [-.129099, 0], [.208887, 0], [-.252557, 0], [.252557, 0], [.208887, 0], [-.129099, 0], [.182574, 0], [-.235876, 0], [-.172769, 0], [.0797878, 0], [.0269891, 0], [.124855, 0], [.180703, 0], [-.247143, 0], [-.257651, 0], [.220524, 0], [.148915, 0], [.033965, 0], [-.0717459, 0], [.0909187, 0], [.180008, 0], [.234416, 0], [-.256185, 0], [.240189, 0], [.131811, 0]], [[-.182574, 0], [.252557, 0], [-.235876, 0], [-.208887, 0], [-.172769, 0], [.129099, 0], [-.0797878, 0], [.0269891, 0], [.0269891, 0], [.0797878, 0], [-.129099, 0], [-.182574, 0], [.252557, 0], [.235876, 0], [-.208887, 0], [.172769, 0], [.0751376, 0], [.090068, 0], [-.156009, 0], [-.184894, 0], [.226567, 0], [.246623, 0], [.258103, 0], [.254171, 0], [-.0386876, 0], [-.089157, 0], [-.126025, 0], [.195339, 0], [-.202144, 0], [-.251885, 0]], [[-.182574, 0], [.258199, 0], [-.258199, 0], [-.258199, 0], [-.258199, 0], [.258199, 0], [-.258199, 0], [.258199, 0], [-.258199, 0], [-.258199, 0], [.258199, 0], [.182574, 0], [-.258199, 0], [-.258199, 0], [.258199, 0], [-.258199, 0], [.0221364, 0], [-.016141, 0], [-.00528513, 0], [.0102149, 0], [.00604225, 0], [.00350618, 0], [.0199933, 0], [.0186096, 0], [-.0152344, 0], [-.0171104, 0], [-.0305038, 0], [-.00522948, 0], [-.0380449, 0], [.0238625, 0]], [[-.182574, 0], [.252557, 0], [-.235876, 0], [-.208887, 0], [-.172769, 0], [.129099, 0], [-.0797878, 0], [.0269891, 0], [.0269891, 0], [.0797878, 0], [-.129099, 0], [-.182574, 0], [.252557, 0], [.235876, 0], [-.208887, 0], [.172769, 0], [-.0318322, 0], [-.119559, 0], [.147458, 0], [.198564, 0], [-.220524, 0], [-.244456, 0], [-.253924, 0], [-.258062, 0], [.0684905, 0], [.120419, 0], [.175381, 0], [-.188341, 0], [.240189, 0], [.237137, 0]], [[-.182574, 0], [.235876, 0], [-.172769, 0], [-.0797878, 0], [.0269891, 0], [-.129099, 0], [.208887, 0], [-.252557, 0], [.252557, 0], [.208887, 0], [-.129099, 0], [.182574, 0], [-.235876, 0], [-.172769, 0], [.0797878, 0], [.0269891, 0], [-.0844097, 0], [-.202304, 0], [.243877, 0], [.255516, 0], [-.226567, 0], [-.154588, 0], [-.0730778, 0], [.03534, 0], [-.118753, 0], [-.202906, 0], [-.253268, 0], [.257278, 0], [-.202144, 0], [-.170421, 0]], [[-.182574, 0], [.208887, 0], [-.0797878, 0], [.0797878, 0], [.208887, 0], [-.258199, 0], [.208887, 0], [-.0797878, 0], [-.0797878, 0], [-.208887, 0], [.258199, 0], [-.182574, 0], [.208887, 0], [.0797878, 0], [.0797878, 0], [-.208887, 0], [-.133298, 0], [-.250069, 0], [.247143, 0], [.143383, 0], [-.00604225, 0], [.148915, 0], [.238646, 0], [.250674, 0], [.163826, 0], [.250309, 0], [.234416, 0], [-.155965, 0], [-.0380449, 0], [-.131811, 0]], [[-.182574, 0], [.172769, 0], [.0269891, 0], [.208887, 0], [.252557, 0], [-.129099, 0], [-.0797878, 0], [.235876, 0], [-.235876, 0], [-.0797878, 0], [-.129099, 0], [.182574, 0], [-.172769, 0], [.0269891, 0], [-.208887, 0], [.252557, 0], [-.176361, 0], [-.254595, 0], [.156009, 0], [-.0636322, 0], [.220524, 0], [.246623, 0], [.122968, 0], [-.0877451, 0], [-.201739, 0], [-.254431, 0], [-.126025, 0], [-.0485564, 0], [.240189, 0], [.251885, 0]], [[-.182574, 0], [.129099, 0], [.129099, 0], [.258199, 0], [.129099, 0], [.129099, 0], [-.258199, 0], [.129099, 0], [.129099, 0], [.258199, 0], [-.129099, 0], [-.182574, 0], [.129099, 0], [-.129099, 0], [.258199, 0], [-.129099, 0], [-.211715, 0], [-.215099, 0], [.00528513, 0], [-.228539, 0], [.226567, 0], [.00350618, 0], [-.212939, 0], [-.23233, 0], [.230834, 0], [.21456, 0], [-.0305038, 0], [.220946, 0], [-.202144, 0], [-.0238625, 0]], [[-.182574, 0], [.0797878, 0], [.208887, 0], [.208887, 0], [-.0797878, 0], [.258199, 0], [-.0797878, 0], [-.208887, 0], [.208887, 0], [-.0797878, 0], [.258199, 0], [.182574, 0], [-.0797878, 0], [.208887, 0], [-.208887, 0], [-.0797878, 0], [-.237817, 0], [-.13841, 0], [-.147458, 0], [-.242213, 0], [.00604225, 0], [-.244456, 0], [-.167485, 0], [.136315, 0], [-.249842, 0], [-.137589, 0], [.175381, 0], [-.247127, 0], [-.0380449, 0], [-.237137, 0]], [[-.182574, 0], [.0269891, 0], [.252557, 0], [.0797878, 0], [-.235876, 0], [.129099, 0], [.208887, 0], [-.172769, 0], [-.172769, 0], [-.208887, 0], [-.129099, 0], [-.182574, 0], [.0269891, 0], [-.252557, 0], [.0797878, 0], [.235876, 0], [-.253525, 0], [-.0377892, 0], [-.243877, 0], [-.095605, 0], [-.220524, 0], [-.154588, 0], [.177925, 0], [.203832, 0], [.25793, 0], [.0368281, 0], [-.253268, 0], [.109775, 0], [.240189, 0], [.170421, 0]], [[-.182574, 0], [-.0269891, 0], [.252557, 0], [-.0797878, 0], [-.235876, 0], [-.129099, 0], [.208887, 0], [.172769, 0], [-.172769, 0], [.208887, 0], [-.129099, 0], [.182574, 0], [.0269891, 0], [.252557, 0], [.0797878, 0], [-.235876, 0], [-.258153, 0], [.0693659, 0], [-.247143, 0], [.114268, 0], [-.226567, 0], [.148915, 0], [.204681, 0], [-.178928, 0], [-.254745, 0], [.070301, 0], [.234416, 0], [.10022, 0], [-.202144, 0], [.131811, 0]], [[-.182574, 0], [-.0797878, 0], [.208887, 0], [-.208887, 0], [-.0797878, 0], [-.258199, 0], [-.0797878, 0], [.208887, 0], [.208887, 0], [.0797878, 0], [.258199, 0], [-.182574, 0], [-.0797878, 0], [-.208887, 0], [-.208887, 0], [.0797878, 0], [-.251498, 0], [.164527, 0], [-.156009, 0], [.248526, 0], [-.00604225, 0], [.246623, 0], [-.135135, 0], [-.166426, 0], [.240426, 0], [-.165274, 0], [-.126025, 0], [-.243895, 0], [-.0380449, 0], [-.251885, 0]], [[-.182574, 0], [-.129099, 0], [.129099, 0], [-.258199, 0], [.129099, 0], [-.129099, 0], [-.258199, 0], [-.129099, 0], [.129099, 0], [-.258199, 0], [-.129099, 0], [.182574, 0], [.129099, 0], [.129099, 0], [.258199, 0], [.129099, 0], [-.233852, 0], [.23124, 0], [-.00528513, 0], [.218324, 0], [.220524, 0], [.00350618, 0], [-.232932, 0], [.21372, 0], [-.2156, 0], [.23167, 0], [-.0305038, 0], [.226176, 0], [.240189, 0], [.0238625, 0]], [[-.182574, 0], [-.172769, 0], [.0269891, 0], [-.208887, 0], [.252557, 0], [.129099, 0], [-.0797878, 0], [-.235876, 0], [-.235876, 0], [.0797878, 0], [-.129099, 0], [-.182574, 0], [-.172769, 0], [-.0269891, 0], [-.208887, 0], [-.252557, 0], [-.205985, 0], [.257969, 0], [.147458, 0], [.0436489, 0], [.226567, 0], [-.244456, 0], [.0864388, 0], [.121747, 0], [.181351, 0], [-.258009, 0], [.175381, 0], [-.0587868, 0], [-.202144, 0], [.237137, 0]], [[-.182574, 0], [-.208887, 0], [-.0797878, 0], [-.0797878, 0], [.208887, 0], [.258199, 0], [.208887, 0], [.0797878, 0], [-.0797878, 0], [.208887, 0], [.258199, 0], [.182574, 0], [.208887, 0], [-.0797878, 0], [.0797878, 0], [.208887, 0], [-.169115, 0], [.240094, 0], [.243877, 0], [-.159911, 0], [.00604225, 0], [-.154588, 0], [.251003, 0], [-.239172, 0], [-.139176, 0], [.239735, 0], [-.253268, 0], [-.147504, 0], [-.0380449, 0], [-.170421, 0]], [[-.182574, 0], [-.235876, 0], [-.172769, 0], [.0797878, 0], [.0269891, 0], [.129099, 0], [.208887, 0], [.252557, 0], [.252557, 0], [-.208887, 0], [-.129099, 0], [-.182574, 0], [-.235876, 0], [.172769, 0], [.0797878, 0], [-.0269891, 0], [-.124855, 0], [.180703, 0], [.247143, 0], [-.257651, 0], [-.220524, 0], [.148915, 0], [-.033965, 0], [-.0717459, 0], [.0909187, 0], [-.180008, 0], [.234416, 0], [.256185, 0], [.240189, 0], [-.131811, 0]], [[-.182574, 0], [-.252557, 0], [-.235876, 0], [.208887, 0], [-.172769, 0], [-.129099, 0], [-.0797878, 0], [-.0269891, 0], [.0269891, 0], [-.0797878, 0], [-.129099, 0], [.182574, 0], [.252557, 0], [-.235876, 0], [-.208887, 0], [-.172769, 0], [-.0751376, 0], [.090068, 0], [.156009, 0], [-.184894, 0], [-.226567, 0], [.246623, 0], [-.258103, 0], [.254171, 0], [-.0386876, 0], [.089157, 0], [-.126025, 0], [-.195339, 0], [-.202144, 0], [.251885, 0]]];
var D = [[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [.0437048, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [.172909, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [.381966, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [.661739, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1.38197, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1.79094, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [2.20906, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [2.61803, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [4, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3.9563, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3.82709, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3.61803, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3.33826, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [.0437048, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [.172909, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [.381966, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [.661739, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1.38197, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1.79094, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [2.20906, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3.9563, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3.82709, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3.61803, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3.33826, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [3, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [2.61803, 0]]];
var Vinv = [[[-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0], [-.182574, -0]], [[-.258199, 0], [-.257176, 0], [-.244913, 0], [-.221947, 0], [-.18928, 0], [-.148341, 0], [-.100919, 0], [-.0490856, 0], [.00489264, 0], [.0586571, 0], [.109858, 0], [.156257, 0], [.195828, 0], [.226839, 0], [.247937, 0], [.258199, 0], [.257176, 0], [.244913, 0], [.221947, 0], [.18928, 0], [.148341, 0], [.100919, 0], [.0490856, 0], [-.00489264, 0], [-.0586571, 0], [-.109858, 0], [-.156257, 0], [-.195828, 0], [-.226839, 0], [-.247937, 0]], [[-.258199, 0], [-.229298, 0], [-.16075, 0], [-.0644067, 0], [.0430732, 0], [.143105, 0], [.218393, 0], [.255919, 0], [.249194, 0], [.199381, 0], [.115093, 0], [.0109051, 0], [-.095169, 0], [-.184787, 0], [-.242454, 0], [-.258199, 0], [-.229298, 0], [-.16075, 0], [-.0644067, 0], [.0430732, 0], [.143105, 0], [.218393, 0], [.255919, 0], [.249194, 0], [.199381, 0], [.115093, 0], [.0109051, 0], [-.095169, 0], [-.184787, 0], [-.242454, 0]], [[.258199, -0], [.211994, -0], [.0848154, -0], [-.0747603, -0], [-.20578, -0], [-.258199, -0], [-.211994, -0], [-.0848154, -0], [.0747603, -0], [.20578, -0], [.258199, -0], [.211994, -0], [.0848154, -0], [-.0747603, -0], [-.20578, -0], [-.258199, -0], [-.211994, -0], [-.0848154, -0], [.0747603, -0], [.20578, -0], [.258199, -0], [.211994, -0], [.0848154, -0], [-.0747603, -0], [-.20578, -0], [-.258199, -0], [-.211994, -0], [-.0848154, -0], [.0747603, -0], [.20578, -0]], [[-.258199, 0], [-.165172, 0], [.037156, 0], [.214896, 0], [.250431, 0], [.120246, 0], [-.0895104, 0], [-.240034, 0], [-.231718, 0], [-.0700653, 0], [.137953, 0], [.254682, 0], [.202878, 0], [.0168223, 0], [-.180366, 0], [-.258199, 0], [-.165172, 0], [.037156, 0], [.214896, 0], [.250431, 0], [.120246, 0], [-.0895104, 0], [-.240034, 0], [-.231718, 0], [-.0700653, 0], [.137953, 0], [.254682, 0], [.202878, 0], [.0168223, 0], [-.180366, 0]], [[-.258199, -0], [-.134334, -0], [.123865, -0], [.258199, -0], [.134334, -0], [-.123865, -0], [-.258199, -0], [-.134334, -0], [.123865, -0], [.258199, -0], [.134334, -0], [-.123865, -0], [-.258199, -0], [-.134334, -0], [.123865, -0], [.258199, -0], [.134334, -0], [-.123865, -0], [-.258199, -0], [-.134334, -0], [.123865, -0], [.258199, -0], [.134334, -0], [-.123865, -0], [-.258199, -0], [-.134334, -0], [.123865, -0], [.258199, -0], [.134334, -0], [-.123865, -0]], [[-.258199, 0], [-.0831227, 0], [.206826, 0], [.210948, 0], [-.076453, 0], [-.258199, 0], [-.0831227, 0], [.206826, 0], [.210948, 0], [-.076453, 0], [-.258199, 0], [-.0831227, 0], [.206826, 0], [.210948, 0], [-.076453, 0], [-.258199, 0], [-.0831227, 0], [.206826, 0], [.210948, 0], [-.076453, 0], [-.258199, 0], [-.0831227, 0], [.206826, 0], [.210948, 0], [-.076453, 0], [-.258199, 0], [-.0831227, 0], [.206826, 0], [.210948, 0], [-.076453, 0]], [[-.258199, 0], [-.0469328, 0], [.248387, 0], [.0988599, 0], [-.22772, 0], [-.146466, 0], [.1971, 0], [.187671, 0], [-.157866, 0], [-.220674, 0], [.111733, 0], [.244033, 0], [-.0607158, 0], [-.256726, 0], [.00704546, 0], [.258199, 0], [.0469328, 0], [-.248387, 0], [-.0988599, 0], [.22772, 0], [.146466, 0], [-.1971, 0], [-.187671, 0], [.157866, 0], [.220674, 0], [-.111733, 0], [-.244033, 0], [.0607158, 0], [.256726, 0], [-.00704546, 0]], [[-.258199, -0], [.00843317, -0], [.256436, -0], [-.0620429, -0], [-.243465, -0], [.112941, -0], [.219854, -0], [-.158903, -0], [-.186635, -0], [.19792, -0], [.145258, -0], [-.228287, -0], [-.0975328, -0], [.248677, -0], [.0455451, -0], [-.258199, -0], [.00843317, -0], [.256436, -0], [-.0620429, -0], [-.243465, -0], [.112941, -0], [.219854, -0], [-.158903, -0], [-.186635, -0], [.19792, -0], [.145258, -0], [-.228287, -0], [-.0975328, -0], [.248677, -0], [.0455451, -0]], [[.258199, 0], [-.10258, 0], [-.194801, 0], [.222974, 0], [.0569957, 0], [-.258199, 0], [.10258, 0], [.194801, 0], [-.222974, 0], [-.0569957, 0], [.258199, 0], [-.10258, 0], [-.194801, 0], [.222974, 0], [.0569957, 0], [-.258199, 0], [.10258, 0], [.194801, 0], [-.222974, 0], [-.0569957, 0], [.258199, 0], [-.10258, 0], [-.194801, 0], [.222974, 0], [.0569957, 0], [-.258199, 0], [.10258, 0], [.194801, 0], [-.222974, 0], [-.0569957, 0]], [[.258199, 0], [-.095788, 0], [-.162411, 0], [.258199, 0], [-.095788, 0], [-.162411, 0], [.258199, 0], [-.095788, 0], [-.162411, 0], [.258199, 0], [-.095788, 0], [-.162411, 0], [.258199, 0], [-.095788, 0], [-.162411, 0], [.258199, 0], [-.095788, 0], [-.162411, 0], [.258199, 0], [-.095788, 0], [-.162411, 0], [.258199, 0], [-.095788, 0], [-.162411, 0], [.258199, 0], [-.095788, 0], [-.162411, 0], [.258199, 0], [-.095788, 0], [-.162411, 0]], [[-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0], [-.182574, -0], [.182574, -0]], [[-.258199, -0], [.249384, -0], [-.229669, -0], [.199917, -0], [-.161428, -0], [.115883, -0], [-.0652738, -0], [.0118118, -0], [.0421665, -0], [-.0943019, -0], [.142316, -0], [-.18411, -0], [.217857, -0], [-.242084, -0], [.25573, -0], [-.258199, -0], [.249384, -0], [-.229669, -0], [.199917, -0], [-.161428, -0], [.115883, -0], [-.0652738, -0], [.0118118, -0], [.0421665, -0], [-.0943019, -0], [.142316, -0], [-.18411, -0], [.217857, -0], [-.242084, -0], [.25573, -0]], [[.258199, 0], [-.228902, 0], [.160025, 0], [-.0634791, 0], [-.0440433, 0], [.14395, 0], [-.218967, 0], [.256122, 0], [-.248991, 0], [.198808, 0], [-.114249, 0], [.00993502, 0], [.0960966, 0], [-.185512, 0], [.242851, 0], [-.258199, 0], [.228902, 0], [-.160025, 0], [.0634791, 0], [.0440433, 0], [-.14395, 0], [.218967, 0], [-.256122, 0], [.248991, 0], [-.198808, 0], [.114249, 0], [-.00993502, 0], [-.0960966, 0], [.185512, 0], [-.242851, 0]], [[.258199, -0], [-.190831, -0], [.0505724, -0], [.109003, -0], [-.226943, -0], [.258199, -0], [-.190831, -0], [.0505724, -0], [.109003, -0], [-.226943, -0], [.258199, -0], [-.190831, -0], [.0505724, -0], [.109003, -0], [-.226943, -0], [.258199, -0], [-.190831, -0], [.0505724, -0], [.109003, -0], [-.226943, -0], [.258199, -0], [-.190831, -0], [.0505724, -0], [.109003, -0], [-.226943, -0], [.258199, -0], [-.190831, -0], [.0505724, -0], [.109003, -0], [-.226943, -0]], [[.258199, -0], [-.176656, -0], [-.0217872, -0], [.205813, -0], [-.253644, -0], [.133629, -0], [.0748133, -0], [-.233749, -0], [.238004, -0], [-.0847624, -0], [-.12457, -0], [.251469, -0], [-.211962, -0], [.032191, -0], [.168882, -0], [-.258199, -0], [.176656, -0], [.0217872, -0], [-.205813, -0], [.253644, -0], [-.133629, -0], [-.0748133, -0], [.233749, -0], [-.238004, -0], [.0847624, -0], [.12457, -0], [-.251469, -0], [.211962, -0], [-.032191, -0], [-.168882, -0]], [[0, 0], [.053881, -0], [.105407, -0], [.152326, -0], [.192588, -0], [.224433, -0], [.246469, -0], [.257733, -0], [.257733, -0], [.246469, -0], [.224433, -0], [.192588, -0], [.152326, -0], [.105407, -0], [.053881, -0], [0, 0], [-.053881, -0], [-.105407, -0], [-.152326, -0], [-.192588, -0], [-.224433, -0], [-.246469, -0], [-.257733, -0], [-.257733, -0], [-.246469, -0], [-.224433, -0], [-.192588, -0], [-.152326, -0], [-.105407, -0], [-.053881, -0]], [[0, 0], [-.105225, -0], [-.192255, -0], [-.246043, -0], [-.257288, -0], [-.224045, -0], [-.152063, -0], [-.0537878, -0], [.0537878, -0], [.152063, -0], [.224045, -0], [.257288, -0], [.246043, -0], [.192255, -0], [.105225, -0], [0, 0], [-.105225, -0], [-.192255, -0], [-.246043, -0], [-.257288, -0], [-.224045, -0], [-.152063, -0], [-.0537878, -0], [.0537878, -0], [.152063, -0], [.224045, -0], [.257288, -0], [.246043, -0], [.192255, -0], [.105225, -0]], [[0, 0], [-.151797, -0], [-.245613, -0], [-.245613, -0], [-.151797, -0], [0, 0], [.151797, -0], [.245613, -0], [.245613, -0], [.151797, -0], [0, 0], [-.151797, -0], [-.245613, -0], [-.245613, -0], [-.151797, -0], [0, 0], [.151797, -0], [.245613, -0], [.245613, -0], [.151797, -0], [0, 0], [-.151797, -0], [-.245613, -0], [-.245613, -0], [-.151797, -0], [0, 0], [.151797, -0], [.245613, -0], [.245613, -0], [.151797, -0]], [[0, 0], [.19203, -0], [.256986, -0], [.151884, -0], [-.0537246, -0], [-.223782, -0], [-.245754, -0], [-.105101, -0], [.105101, -0], [.245754, -0], [.223782, -0], [.0537246, -0], [-.151884, -0], [-.256986, -0], [-.19203, -0], [0, 0], [.19203, -0], [.256986, -0], [.151884, -0], [-.0537246, -0], [-.223782, -0], [-.245754, -0], [-.105101, -0], [.105101, -0], [.245754, -0], [.223782, -0], [.0537246, -0], [-.151884, -0], [-.256986, -0], [-.19203, -0]], [[0, 0], [.223668, -0], [.223668, -0], [0, 0], [-.223668, -0], [-.223668, -0], [0, 0], [.223668, -0], [.223668, -0], [0, 0], [-.223668, -0], [-.223668, -0], [0, 0], [.223668, -0], [.223668, -0], [0, 0], [-.223668, -0], [-.223668, -0], [0, 0], [.223668, -0], [.223668, -0], [0, 0], [-.223668, -0], [-.223668, -0], [0, 0], [.223668, -0], [.223668, -0], [0, 0], [-.223668, -0], [-.223668, -0]], [[0, 0], [-.245584, -0], [-.151779, -0], [.151779, -0], [.245584, -0], [0, 0], [-.245584, -0], [-.151779, -0], [.151779, -0], [.245584, -0], [0, 0], [-.245584, -0], [-.151779, -0], [.151779, -0], [.245584, -0], [0, 0], [-.245584, -0], [-.151779, -0], [.151779, -0], [.245584, -0], [0, 0], [-.245584, -0], [-.151779, -0], [.151779, -0], [.245584, -0], [0, 0], [-.245584, -0], [-.151779, -0], [.151779, -0], [.245584, -0]], [[0, 0], [.257558, -0], [.0538442, -0], [-.246301, -0], [-.105335, -0], [.22428, -0], [.152223, -0], [-.192457, -0], [-.192457, -0], [.152223, -0], [.22428, -0], [-.105335, -0], [-.246301, -0], [.0538442, -0], [.257558, -0], [0, 0], [-.257558, -0], [-.0538442, -0], [.246301, -0], [.105335, -0], [-.22428, -0], [-.152223, -0], [.192457, -0], [.192457, -0], [-.152223, -0], [-.22428, -0], [.105335, -0], [.246301, -0], [-.0538442, -0], [-.257558, -0]], [[0, 0], [-.257454, 0], [.0538225, 0], [.246202, 0], [-.105293, 0], [-.22419, 0], [.152161, 0], [.19238, 0], [-.19238, 0], [-.152161, 0], [.22419, 0], [.105293, 0], [-.246202, 0], [-.0538225, 0], [.257454, 0], [0, 0], [-.257454, 0], [.0538225, 0], [.246202, 0], [-.105293, 0], [-.22419, 0], [.152161, 0], [.19238, 0], [-.19238, 0], [-.152161, 0], [.22419, 0], [.105293, 0], [-.246202, 0], [-.0538225, 0], [.257454, 0]], [[0, 0], [.0537763, 0], [-.105202, 0], [.15203, 0], [-.192214, 0], [.223997, 0], [-.24599, 0], [.257233, 0], [-.257233, 0], [.24599, 0], [-.223997, 0], [.192214, 0], [-.15203, 0], [.105202, 0], [-.0537763, 0], [0, 0], [.0537763, 0], [-.105202, 0], [.15203, 0], [-.192214, 0], [.223997, 0], [-.24599, 0], [.257233, 0], [-.257233, 0], [.24599, 0], [-.223997, 0], [.192214, 0], [-.15203, 0], [.105202, 0], [-.0537763, 0]], [[0, 0], [-.10525, 0], [.192302, 0], [-.246103, 0], [.25735, 0], [-.224099, 0], [.1521, 0], [-.0538008, 0], [-.0538008, 0], [.1521, 0], [-.224099, 0], [.25735, 0], [-.246103, 0], [.192302, 0], [-.10525, 0], [0, 0], [.10525, 0], [-.192302, 0], [.246103, 0], [-.25735, 0], [.224099, 0], [-.1521, 0], [.0538008, 0], [.0538008, 0], [-.1521, 0], [.224099, 0], [-.25735, 0], [.246103, 0], [-.192302, 0], [.10525, 0]], [[0, 0], [.152836, -0], [-.247294, -0], [.247294, -0], [-.152836, -0], [0, 0], [.152836, -0], [-.247294, -0], [.247294, -0], [-.152836, -0], [0, 0], [.152836, -0], [-.247294, -0], [.247294, -0], [-.152836, -0], [0, 0], [.152836, -0], [-.247294, -0], [.247294, -0], [-.152836, -0], [0, 0], [.152836, -0], [-.247294, -0], [.247294, -0], [-.152836, -0], [0, 0], [.152836, -0], [-.247294, -0], [.247294, -0], [-.152836, -0]], [[0, 0], [.191919, -0], [-.256837, -0], [.151797, -0], [.0536936, -0], [-.223653, -0], [.245612, -0], [-.10504, -0], [-.10504, -0], [.245612, -0], [-.223653, -0], [.0536936, -0], [.151797, -0], [-.256837, -0], [.191919, -0], [0, 0], [-.191919, -0], [.256837, -0], [-.151797, -0], [-.0536936, -0], [.223653, -0], [-.245612, -0], [.10504, -0], [.10504, -0], [-.245612, -0], [.223653, -0], [-.0536936, -0], [-.151797, -0], [.256837, -0], [-.191919, -0]], [[0, 0], [.226074, 0], [-.226074, 0], [0, 0], [.226074, 0], [-.226074, 0], [0, 0], [.226074, 0], [-.226074, 0], [0, 0], [.226074, 0], [-.226074, 0], [0, 0], [.226074, 0], [-.226074, 0], [0, 0], [.226074, 0], [-.226074, 0], [0, 0], [.226074, 0], [-.226074, 0], [0, 0], [.226074, 0], [-.226074, 0], [0, 0], [.226074, 0], [-.226074, 0], [0, 0], [.226074, 0], [-.226074, 0]], [[0, 0], [-.246617, -0], [.152418, -0], [.152418, -0], [-.246617, -0], [0, 0], [.246617, -0], [-.152418, -0], [-.152418, -0], [.246617, -0], [0, 0], [-.246617, -0], [.152418, -0], [.152418, -0], [-.246617, -0], [0, 0], [.246617, -0], [-.152418, -0], [-.152418, -0], [.246617, -0], [0, 0], [-.246617, -0], [.152418, -0], [.152418, -0], [-.246617, -0], [0, 0], [.246617, -0], [-.152418, -0], [-.152418, -0], [.246617, -0]]];
  
var psi = [[[20, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]], [[1, 0]]]; // column vector (ket)
var time = 0;

nodes = [];
links = [];

for (var i = 0; i < laplacian.length; i++) {
    nodes.push({ x: width/2+getRandomInt(0,20), y: height/2+getRandomInt(0,20), state: psi[i][0], id: i}); //{name: names[i], id: i, reflexive: false, highlighted:false } );
}

if(directed) {
  for (var i = 0; i < laplacian.length; i++) {
      for (var j = 0; j < laplacian.length; j++) {
        if( i != j && laplacian[i][j][0] == -1) {
          links.push( { source: i, target: j } );
        }
      }
  }
}else{
  for (var i = 0; i < laplacian.length; i++) {
      for (var j = i; j < laplacian.length; j++) {
        if( i != j && laplacian[i][j][0] == -1) {
          links.push( { source: i, target: j } );
        }
      }
  }
}


console.log(nodes);
console.log(links);

//console.log(matrixExponential(laplacian,15));

force = d3.layout.force()
    .nodes(nodes)
    .links(links)
    .size([width, height])
    .linkDistance(10) //30 or 60
    .linkStrength(3)
    .charge(-100) // -500
    .gravity(0.01);
    
force.start();

grads = [];
for(var i = 0; i < links.length; i++) {
  d = links[i];
  var id = "S"+d.source.id +"T" + d.target.id;
  
  var grad = defs.append("linearGradient")
    .attr("gradientUnits", "userSpaceOnUse")
    .attr('x2', function(df) { return d.source.x; })
    .attr('y2', function(df) { return d.source.y; })
    .attr('x1', function(df) { return d.target.x; })
    .attr('y1', function(df) { return d.target.y; })
    .attr("id",  id);
    //.attr("gradientTransform", "rotate(" + angle + ")");
  grad.append("stop").attr("offset", "0%").attr("stop-color", color(d.target.state[0]));
  grad.append("stop").attr("offset", "100%").attr("stop-color", color(d.source.state[0]));
  grads.push(grad);
}

/*
nodestyles = [];
for(var i = 0; i < nodes.length; i++) {
  d = nodes[i];
  var st = defs.append("fill");
}*/

/*var node = svg.selectAll('.node')
    .data(nodes)
    .enter().append('circle')
    .attr('class', 'node')
    .attr('r', 5)
    //.attr('opacity',0)
    .attr('cx', function(d) { return d.x; })
    .attr('cy', function(d) { return d.y; })
    .attr('id', function(d) {
      return "N"+d.id;
    })
    .style("fill", function(d){
          var id = "N"+d.id;
          return "url(#" + id + ")";
      })
    .call(force.drag);*/
    
var link = svg.selectAll('.link')
    .data(links)
    .enter().append('line')
    .attr('class', 'link')
    .attr("marker-end", "url(#child)")
    .attr('x1', function(d) { return d.source.x; })
    .attr('y1', function(d) { return d.source.y; })
    .attr('x2', function(d) { return d.target.x; })
    .attr('y2', function(d) { return d.target.y; })
    .style("stroke-width", function(d) { return 10; })
    .style("stroke", function(d){
          var id = "S"+d.source.id +"T" + d.target.id;
          return "url(#" + id + ")";
      });
    
var node = svg.selectAll('.node')
    .data(nodes)
    .enter().append("g")
        .attr("class", "node")
        .call(force.drag);
    
node.append("circle")
        .attr("class", "node")
        .attr("x", function(d) { return d.x; })
        .attr("y", function(d) { return d.y; })
        .attr("r", 5)
        .attr('id', function(d) {
      return "N"+d.id;
    })
    .style("fill", function(d){
          var id = "N"+d.id;
          return "url(#" + id + ")";
      })
    .style("stroke", "black");
    
node.append("text")
        .attr("class", "nodetext")
        .attr("dx", 12)
        .attr("dy", ".35em")
        .text(function(d) { return d.state })
        //.style("fill", "white")
        .attr('id', function(d) {
      return "NT"+d.id;
    });

      
    


    



animationStep = 100;

force.on('tick', visualUpdate);

function visualUpdate() {
  /*node.transition().ease('linear').duration(animationStep)
        .attr('cx', function(d) { return d.x; })
        .attr('cy', function(d) { return d.y; });

    link.transition().ease('linear').duration(animationStep)
        .attr('x1', function(d) { return d.source.x; })
        .attr('y1', function(d) { return d.source.y; })
        .attr('x2', function(d) { return d.target.x; })
        .attr('y2', function(d) { return d.target.y; });*/
        
    link.attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });
        
    node.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

    for(var i = 0; i < nodes.length; i++) {
      //nodes[i].state = newpsi[i][0];
      //console.log(colortype);
      //console.log(directed);
      if(colortype == "norm") {
        d3.select("#N"+i).style("fill", color(norm(nodes[i].state)));
      }else if(colortype == "real") {
        d3.select("#N"+i).style("fill", color(nodes[i].state[0]));
      }else if(colortype == "imaginary") {
        d3.select("#N"+i).style("fill", color(nodes[i].state[1]));
      }
      if(nodes[i].state[1] >=0) {
        d3.select("#NT"+i).text(Math.floor(nodes[i].state[0]*10)/10 + " + " +  Math.floor(nodes[i].state[1]*10)/10 + "i");
      }else{
        d3.select("#NT"+i).text(Math.floor(nodes[i].state[0]*10)/10 + " - " +  Math.abs(Math.floor(nodes[i].state[1]*10)/10) + "i");
      }
      // NO TEXT 
      d3.select("#NT"+i).text("");
    }

    for(var i = 0; i < links.length; i++) {
      d = links[i];
      var id = "S"+d.source.id +"T" + d.target.id;
      grad = document.getElementById(id);
      grad.setAttribute("x2", d.source.x);
      grad.setAttribute("y2", d.source.y);
      grad.setAttribute("x1", d.target.x);
      grad.setAttribute("y1", d.target.y);
      if(!fastrender) {
        if(colortype == "norm") {
          grad.childNodes[0].setAttribute("stop-color", color(norm(d.target.state))) // 0% stop
          grad.childNodes[1].setAttribute("stop-color", color(norm(d.source.state))) // 100% stop
        }else if(colortype == "real") {
          grad.childNodes[0].setAttribute("stop-color", color(d.target.state[0])) // 0% stop
          grad.childNodes[1].setAttribute("stop-color", color(d.source.state[0])) // 100% stop
        }else if(colortype == "imaginary") {
          grad.childNodes[0].setAttribute("stop-color", color(d.target.state[1])) // 0% stop
          grad.childNodes[1].setAttribute("stop-color", color(d.source.state[1])) // 100% stop
        }
      }else{
        if(colortype == "norm") {
          c = blend_colors(color(norm(d.target.state)), color(norm(d.source.state)), 0.5);
          grad.childNodes[0].setAttribute("stop-color", c) // 0% stop
          grad.childNodes[1].setAttribute("stop-color", c) // 100% stop
        }
      }
    }
    //d3.select(this.parentNode).select("text").text(function(d) {return d.name}); 
}



// Actual calculations, on loop

setInterval(function() {
  // tick animation
    // Old operator---caculuate power of laplacian directly. In these enlightented times, we prefer diagonalization
    //operator = matrixExponential(scalarProduct(laplacian,-time),36);
    console.log("calculation step");
    operator = diagonalExponentialCC(scalarProductCC(D, [0,-time]));
    console.log(operator);
    operator = matrixProductCC(V, matrixProductCC(operator, Vinv));
    console.log(operator);
    newpsi = matrixProductCC(operator,psi);
    console.log(psi);
    console.log(newpsi);
    for(var i = 0; i < nodes.length; i++) {
      nodes[i].state = newpsi[i][0];
    }
    time+=0.1; //.1 = real time 0.02 = standard
    
    visualUpdate();
}, animationStep);






//------------------------------
// Helper functions
//------------------------------


//------------------------------
// MATH
//------------------------------

function getRandomInt(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

// complex norm
function norm(z) {
  return Math.sqrt(z[0]*z[0] + z[1]*z[1]);
}

// complex multiplication
function FOIL(x, z) {
  var Re = x[0] * z[0] - x[1]*z[1];
  var Im = x[1] * z[0] + x[0]*z[1];
  return [Re, Im];
}

// complex addition
function addCC(x, z) {
  var Re = x[0] + z[0];
  var Im = x[1] + z[1];
  return [Re, Im];
}

// complex exponent
function euler(x) {
  var Re = Math.exp(x[0]) * Math.cos(x[1]);
  var Im = Math.exp(x[0]) * Math.sin(x[1]);
  return [Re, Im];
}

function factorial(n) {
  // why would you ever need to go higher than this? factorials of 0 through 21
  var factorials = [1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880, 3628800, 39916800, 479001600, 6227020800, 87178291200, 1307674368000, 20922789888000, 355687428096000, 6402373705728000, 121645100408832000, 2432902008176640000, 51090942171709440000];
  if(n < factorials.length) {
    return factorials[n];
  }else{
    return factorial(n-1) * n;
  }
}

// max precision 
function matrixExponential(A, precision) {
  result = identityMatrix(A.length);
  for(var i=1; i<=precision; i++) {
    result = matrixAddition(result, scalarProduct(matrixPower(A, i), 1/factorial(i)));
  }
  return result;
}

function diagonalExponential(D) {
  result = identityMatrix(D.length);
  for(var i=0; i < D.length; i++) {
    result[i][i] = Math.exp(D[i][i]); 
  }
  return result;
}

function diagonalExponentialCC(D) {
  result = identityMatrixCC(D.length);
  for(var i=0; i < D.length; i++) {
    result[i][i] = euler(D[i][i]); 
  }
  return result;
}

function matrixPower(A, n) {
  if(n==0) {
    return identityMatrix(A.length);
  }
  result = A;
  for(var i=1; i<n; i++) {
    result = matrixProduct(result, A);
  }
  return result;
}

function scalarProduct(A, c) {
  result = [];
  for(var i=0; i < A.length; i++) {
    row = [];
    for(var j=0; j < A[0].length; j++) {
      row.push(A[i][j]*c);
    }
    result.push(row);
  }
  return result;
}

function scalarProductCC(A, c) {
  result = [];
  for(var i=0; i < A.length; i++) {
    row = [];
    for(var j=0; j < A[0].length; j++) {
      row.push(FOIL(A[i][j],c));
    }
    result.push(row);
  }
  return result;
}

function matrixAddition(A, B) {
  result = [];
  for(var i=0; i < A.length; i++) {
    row = [];
    for(var j=0; j < A[0].length; j++) {
      row.push(A[i][j] + B[i][j]);
    }
    result.push(row);
  }
  return result;
}

function matrixAdditionCC(A, B) {
  result = [];
  for(var i=0; i < A.length; i++) {
    row = [];
    for(var j=0; j < A[0].length; j++) {
      row.push(addCC(A[i][j],B[i][j]));
    }
    result.push(row);
  }
  return result;
}
  
  
function matrixProduct(A, B) {
  //we'll say that A is a x b and B is c x d
  var a = A.length;
  var b = A[0].length;
  var c = B.length;
  var d = B[0].length;
  
  if(b != c) {
    // dimension mismatch
    return -1;
  }
  
  result = [];
  for(var i=0; i < a; i++) {
    row = [];
    for(var j=0; j < d; j++) {
      // dot product--- A's ith row DOT B's jth column
      sum = 0;
      for(var k=0; k < b; k++) {
        sum += A[i][k] * B[k][j];
      }
      row.push(sum);
    }
    result.push(row);
  }
  return result;
}

function matrixProductCC(A, B) {
  //we'll say that A is a x b and B is c x d
  var a = A.length;
  var b = A[0].length;
  var c = B.length;
  var d = B[0].length;
  
  if(b != c) {
    // dimension mismatch
    return -1;
  }
  
  result = [];
  for(var i=0; i < a; i++) {
    row = [];
    for(var j=0; j < d; j++) {
      // dot product--- A's ith row DOT B's jth column
      sum = [0,0];
      for(var k=0; k < b; k++) {
        sum = addCC(sum, FOIL(A[i][k],B[k][j]));
      }
      row.push(sum);
    }
    result.push(row);
  }
  return result;
}

function identityMatrix(n) {
  result = [];
  for(var i=0; i < n; i++) {
    row = [];
    for(var j=0; j < n; j++) {
      if(i==j) { 
        row.push(1);
      }else{
        row.push(0);
      }
    }
    result.push(row);
  }
  return result;
}

function identityMatrixCC(n) {
  result = [];
  for(var i=0; i < n; i++) {
    row = [];
    for(var j=0; j < n; j++) {
      if(i==j) { 
        row.push([1,0]);
      }else{
        row.push([0,0]);
      }
    }
    result.push(row);
  }
  return result;
}

//------------------------------
// COLORS
//------------------------------

function blend_colors(color1, color2, percentage)
{
    // check input
    color1 = color1 || '#000000';
    color2 = color2 || '#ffffff';
    percentage = percentage || 0.5;

    // 1: validate input, make sure we have provided a valid hex
    if (color1.length != 4 && color1.length != 7)
        throw new error('colors must be provided as hexes');

    if (color2.length != 4 && color2.length != 7)
        throw new error('colors must be provided as hexes');    

    if (percentage > 1 || percentage < 0)
        throw new error('percentage must be between 0 and 1');


    // 2: check to see if we need to convert 3 char hex to 6 char hex, else slice off hash
    //      the three character hex is just a representation of the 6 hex where each character is repeated
    //      ie: #060 => #006600 (green)
    if (color1.length == 4)
        color1 = color1[1] + color1[1] + color1[2] + color1[2] + color1[3] + color1[3];
    else
        color1 = color1.substring(1);
    if (color2.length == 4)
        color2 = color2[1] + color2[1] + color2[2] + color2[2] + color2[3] + color2[3];
    else
        color2 = color2.substring(1);   


    // 3: we have valid input, convert colors to rgb
    color1 = [parseInt(color1[0] + color1[1], 16), parseInt(color1[2] + color1[3], 16), parseInt(color1[4] + color1[5], 16)];
    color2 = [parseInt(color2[0] + color2[1], 16), parseInt(color2[2] + color2[3], 16), parseInt(color2[4] + color2[5], 16)];


    // 4: blend
    var color3 = [ 
        (1 - percentage) * color1[0] + percentage * color2[0], 
        (1 - percentage) * color1[1] + percentage * color2[1], 
        (1 - percentage) * color1[2] + percentage * color2[2]
    ];


    // 5: convert to hex
    color3 = '#' + int_to_hex(color3[0]) + int_to_hex(color3[1]) + int_to_hex(color3[2]);


    // return hex
    return color3;
}

/*
    convert a Number to a two character hex string
    must round, or we will end up with more digits than expected (2)
    note: can also result in single digit, which will need to be padded with a 0 to the left
    @param: num         => the number to conver to hex
    @returns: string    => the hex representation of the provided number
*/
function int_to_hex(num)
{
    var hex = Math.round(num).toString(16);
    if (hex.length == 1)
        hex = '0' + hex;
    return hex;
}
</script>
